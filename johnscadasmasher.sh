

#!/bin/bash

#This is a specific script to enumerate ics and scada systems, Please run with sudo for this to work. 

echo "What is the ip address you want to test?"
read $ip
echo ""
echo ""
echo " just in case do you have another ip in the subnet we can spoof from?"
read $ip2
echo ""
echo ""
echo "Let us start with two basic ports 102 and 502."
echo "We will skip the the host scan in case of a firewall"
sudo nmap -sS $ip  -p 102,502 -Pn
#if there is still no luck unquote this next command
#we will run the scan with a spoofed source IP to see if it evades the firewall
# sudo nmap -sT $ip  -p 102,502 -Pn -S $ip2
echo ""
echo ""
echo " Is Modbus on this? Let us see if we could dig further:"
sudo nmap $ip script=modbus-discover.nse
echo ""
echo ""
echo "another great script for ics/scada systems, checks for the IEC 60870-5-104 ICS protocol:"
sudo nmap $ip script=iec-identify.nse  
echo ""
echo ""
echo "Cool let us see if we can get more aggressive"
nmap -A $ip -p 102, 502, 802, 20000, 4059
echo ""
echo ""
echo "Check all data sheets of PLC for default creds, I have researched things such as Adminitrator/Administrator and Administrator/0000"
echo "some make them set it at first login, pay particular attention to company specifics,slogans, etc"
echo "if you can get in check firewall rules, it can help retrieve MACs for secondary devices."



#see if target is infected with stuxnet: stuxnet-detect.nse, probably not but interesting script
# you can add this to possibly evade firewalls firewall-bypass.nse  
#any findings with 502 or 102 run PLCSCAN

