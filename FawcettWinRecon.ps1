
#priveleges of current user
$priv = whoami /priv

#currentupdates
$updates = wmic qfe

#Get Kereberos Tickets
$tickets = klist

#Check AD Session
$session = net session

# check if Always Elevated is enabled:
$AE1 = gp 'HKCU:\Software\Policies\Microsoft\Windows\Installer' -Name AlwaysInstallElevated
$AE2 = gp 'HKLM:\Software\Policies\Microsoft\Windows\Installer' -Name AlwaysInstallElevated

#find possible Antivirus:
$AVLookup = Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntiVirusProduct

#Look For unquoted service paths:
$pathinfo = wmic service get displayname,pathname

#Look for Programs With Too Much Privelege:
$dangerprograms = Get-WmiObject win32_service | Select-Object Name, State, PathName
| Where-Object {$_.State -like 'Running'}

#show all firewall rules:
$firewall = netsh advfirewall firewall show rule name=all

#You may also need this:
#Set-ExecutionPolicy unrestricted




Write-Host "What do you have the ability to do? "

$priv

Write-Host "What hotfixes do you have on this machine?: "

$updates

Write-Host "Do you have any Kerberos tickets on this machine? "

$tickets

Write-Host "What kind of Session do you have? "

$session

Write-Host "Let us see if Always Ellevated is enabled: "

$AE1
$AE2

Write-Host "What is your Antivirus? "

$AVLookup

Write-Host "You may find Unquoted Service Paths here: "

$pathinfo

Write-Host "Can you find programs that you can run elevated? "

$dangerprograms

Write-Host "Finally Let us see all the firewall rules: "

$firewall


Start-sleep -s 200




